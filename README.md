# Aberrant Sound Module

## О устройстве.
Звуковая карта на базе AY-3-8912 для микрокомпьютера "[Электроника МС 0511](https://ru.wikipedia.org/wiki/%D0%AD%D0%BB%D0%B5%D0%BA%D1%82%D1%80%D0%BE%D0%BD%D0%B8%D0%BA%D0%B0_%D0%9C%D0%A1_0511)" (УКНЦ).
![photo-of-the-module](Doc/IMG_5550.JPG)

## Участники проекта
* Схема - [aberranthacker](https://github.com/aberranthacker)
* Финальная ревизия схемы и трассировка печатной платы - [zloiMOZG](https://github.com/zloiMOZG)

## Особенности
* **3 звукогенератора AY-3-8912**
* **шинные драйверы с инверсией**, прощай программное инвертирование :)
* **разъем расширения** (feature connector), позволяет подключать дополнительные
  устройства к ПП без дублирования логики работы с шиной и дешифрации адресов
* диапазон адресов 0177360-0177377
  * адреса 0177360, 0177362 и 0177364 используются AY-3-8912
  * линии детектора адреса диапазона 0177366-0177377 выведены на future
    connector (P2)
* реализация на дискретной логике в классических **DIP-корпусах** -
  аутентичное "ламповое" решение
* обмен со звукогенераторами реализован так же как на компьютерах серии БК
  * запись слова передаёт адрес регистра AY
  * запись байта передаёт данные в регистр звукогенератора

## Недостатки текущей ревизии платы
* вырез под ключ в нижней части платы, не совпадает с ключём слота ПП, вырез необходимо расширить влево, на половину его ширины
* футпринт кварцевого генератора выполнен зеркально, генератор необходимо развернуть на 180 градусов и пробросить перемычку

## Использование адресов
* 0o177360 AY1
* 0o177362 AY2
* 0o177364 AY3
* 0o177366 -unused- (MIDI control в алтернативной FPGA реализации)
* 0o177370 -unused- (MIDI data в алтернативной FPGA реализации)
* 0o177372 ЦАП (Covox)
* 0o177374 YM3812 (OPL2)
* 0o177376 -unused-

## А есть ли софт?
На данный момент, вывод звука работает в игре [ChibiAkuma's](https://github.com/aberranthacker/chibiakumas), и в музыкальном демо [timeCS](https://github.com/aberranthacker/timeCS).

Портирован [The AKG (generic) player](https://github.com/aberranthacker/akg_player). Для музыки созданной, в пожалуй самом навороченном [Arkos Tracker 2](http://www.julien-nevo.com/arkostracker/). Так же в нём можно создавать звуковые эффекты, не особенно вникая в специфику работы с AY.

Плюс, [адаптирована](https://github.com/aberranthacker/timeCS/blob/master/pt3play2.s) БК-0011М версия проигрывателя `*.pt3`.
Особенностью УКНЦ версии является то, что она рассчитана на работу с треком в
одном из банков памяти. Т.е. считывание трека идёт побайтово, из определённого
банка памяти, используя регистры адреса/данных. В случае использования банков 1
или 2 (а так же, если есть готовность допустить затирание ОЗУ ЦП режима HALT), это
предоставляет возможность проигрывать треки размером до 36К на чип.

## Хочу заказать плату, а где герберы?
`./Project Outputs for aberrant_sound_module/aberrant_sound_module 1.0.0/`

## Соображения
Звуковые возможности УКНЦ ограниченны 1-битной пищалкой. И к сожалению они не были
расширены в те времена, когда трава была зеленее, а эти компьютеры выпускались и массово использовались.

Идея создания звуковой карты для УКНЦ возникла давно, но её реализация стала
актуальной только во время портирования игры ChibiAkuma's, когда появилась
реальная потребность в устройстве подобного рода.

### Основные принципы разработки:
* **Аутентичность**: Устройство собрано из компонентов, доступных в начале 90-х годов,
  что делает его своеобразной фантазией на тему того, каким могло бы быть звуковое
  расширение для УКНЦ, если бы этот компьютер получил большее распространение как бытовой ПК.
* **Компактность**: Размер платы не превышает размер стандартного модуля КГМД.
* **Разъём расширения (future connector)**: Этот разъём позволяет подключать
  дополнительные устройства к периферийному процессору с минимальными усилиями.
